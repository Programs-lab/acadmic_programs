<%= render  'shared/card' do %>
<div id=companies_index>

  <div class="my-8 flex px-4 items-center">
    <div class="flex w-1/2">
      <h4 class="font-semibold text-g-d4 text-lg">
        Empresas
        <br><span class="font-medium text-sm text-g-d2">Listado de empresas</span>
      </h4>
    </div>
    <div class="flex w-1/2 justify-end">
      <%= form_with scope: :company, url: companies_path, method: :post do |form|%>
      <modal-vue>
        <template v-slot:name_button>
          <%= icon('fas','plus', class: 'btn btn-primary cursor-pointer fa-md', "v-ripple" => "'rgba(255, 255, 255, 0.20)'")%>
        </template>
        <template v-slot:title>
          Agrergar Empresa
        </template>
        <template v-slot:content>          
          <div class="flex flex-wrap -mx-3 mb-5">
            <div class="w-full md:w-1/2 px-3 mb-5 md:mb-0 focus_form">
              <%= form.label "Nombre de la empresa", class: 'label_input' %>
              <%= form.text_field :company_name, class: 'field_input rounded-t' %>
            </div>
            <div class="w-full md:w-1/2 px-3 focus_form ">
              <%= form.label "NIT", class: 'label_input' %>
              <%= form.text_field :company_id, class: 'field_input rounded-t' %>
            </div>
          </div>
        </template>
        <template v-slot:footer>
            <%= form.submit "Registrar", class: 'btn btn-primary' %>
        </template>
      </modal-vue>
      <% end %>
    </div>  
  </div>
    <% if @companies.any? %>
      <div class="flex flex-wrap justify-center py-2">        
        <% @companies.each_with_index do |company, index| %>
        <div id="collapse_<%= index %>" class="collapse">
          <div class="row w-full shadow-md">
            <div class="collapse-title">
              <div class="flex w-full justify-start px-4 items-center" v-on:click="close(<%= index %>)">
                <div class="flex w-24 justify-between">
                  <%= icon('fas','building', class: 'fa-md') %>
                  <span><%= company.company_name %></span>
                </div>
              </div>
              <div class="flex w-16 justify-end items-center px-4">
                <%= form_with url: company_path(company.id), method: 'put', class: ""  do |f| %>
                <modal-vue >
                  <template v-slot:name_button>
                    <%= icon('fas','edit', class: 'btn btn-secondary shadow-none cursor-pointer fa-md', "v-on:click" => "close_collapse(#{index})" )%>
                  </template>
                  <template v-slot:title>
                    <%= "Editar empresa #{company.company_name}" %>
                  </template>
                  <template v-slot:content>
                    <div class="flex flex-wrap -mx-3 mb-5">
                      <div id= "lasttNameField" class="w-full md:w-1/2 px-3 mb-5 md:mb-0 focus_form">
                        <%= f.label "Nombre de la empresa", class: 'label_input' %>
                        <%= f.text_field :company_name, value: company.company_name, class: 'field_input rounded-t' %>
                      </div>
                      <div id= "lasttNameField" class="w-full md:w-1/2 px-3 focus_form ">
                        <%= f.label :NIT, class: 'label_input' %>
                        <%= f.text_field :company_id, class: 'field_input rounded-t'%>
                      </div>
                    </div>
                  </template>
                  <template v-slot:footer>
                      <%= f.submit "Registrar", class: "btn btn-primary"%>                    
                  </template>
                </modal-vue>
                <% end %>
              </div>
            </div>
            <div v-show="show[<%= index %>]" class="collapse-content">
              <!-- table heading -->
                <%= form_for("#", html: {'v-cloak' => true},  class: "") do |f| %>
                <div class="row w-full my-5 mx-3 items-center">
                  <% 4.times.each_with_index do |index, value| %>
                  <div class="row w-full mx-3 mb-5 justify-center items-center">
                    <div id= "firstNameField" class="flex w-1/2 px-3 mb-5 md:mb-0 focus_form">
                      <span>Consulta</span>
                    </div>
                    <div id= "lasttNameField" class="row w-1/2 px-3 focus_form">
                      <%= f.label :Costo, class: 'label_input' %>
                      <%= f.text_field :"1", class: 'field_input rounded-t', value: "$ 3000"%>
                    </div>
                  </div>
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
    <% else %>
      <div class="alert alert-info mx-4" role="alert">
        <div class="flex">
          <%= icon('fa', icon_alert['info'], class: 'mr-3 fa-2x') %>
          <div class="text-teal-darkest w-full">
            <p class="font-bold">AtenciÃ³n.</p>
            <p class="text-sm">Aun no se registran empresas, haga click en el '+' para agreagr una</p>
          </div>
        </div>
      </div>
    <% end %>
</div>
<% end %>
