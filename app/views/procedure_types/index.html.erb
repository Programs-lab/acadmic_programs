<%= render  'shared/card' do %>

<div id=procedure_types_index>

  <div class="my-8 flex px-4 items-center">
    <div class="flex w-1/2">
      <h4 class="font-semibold text-g-d4 text-lg">
        Empresas
        <br><span class="font-medium text-sm text-g-d2">Listado de tipos de estudio</span>
      </h4>
    </div>
    <div class="flex w-1/2 justify-end">
      <%= form_with scope: :procedure_type, url: procedure_types_path, method: :post do |form|%>
      <modal-vue>
        <template v-slot:name_button>
          <%= icon('fas','plus', class: 'btn btn-primary cursor-pointer fa-md', "v-ripple" => "'rgba(255, 255, 255, 0.20)'")%>
        </template>
        <template v-slot:title>
          Agrergar Estudio
        </template>
        <template v-slot:content>          
          <div class="flex flex-wrap -mx-3 mb-5">
            <div class="w-full md:w-1/3 px-3 mb-5 md:mb-0 focus_form">
              <%= form.label "Nombre del tipo de estudio", class: 'label_input' %>
              <%= form.text_field :procedure_type_name, class: 'field_input rounded-t' %>
            </div>
            <div class="w-full md:w-1/3 px-3 focus_form ">
              <%= form.label "Costo por defecto", class: 'label_input' %>
              <%= form.number_field :cost, class: 'field_input rounded-t' %>
            </div>
            <div class="w-full md:w-1/3 px-3 focus_form ">
              <%= form.label "Duracion (En minutos)", class: 'label_input' %>
              <%= form.number_field :procedure_duration, class: 'field_input rounded-t' %>
            </div>
          </div>
        </template>
        <template v-slot:footer>
            <%= form.submit "Registrar", class: 'btn btn-primary' %>
        </template>
      </modal-vue>
      <% end %>
    </div>  
  </div>

<% if @procedure_types.any? %>
    <div class="px-0 md:px-4 overflow-auto">
    <!-- table heading -->
    <table class="table">
      <thead>
        <tr>
          <th scope="col" width=13%></th>
          <th scope="col" width=30%>Nombre</th>
          <th scope="col" width=30%>Costo</th>
          <th scope="col" >Duracion</th>
        </tr>
      </thead>
      <tbody class="">
        <% @procedure_types.each_with_index do |procedure_type, index| %>
        <tr>
          <td>
            <%= form_with scope: :procedure_type, url: procedure_type_path(procedure_type.id), method: 'put', class: ""  do |f| %>
            <modal-vue >
              <template v-slot:name_button>
                <%= icon('fas','edit', class: 'btn btn-secondary shadow-none cursor-pointer fa-md', "v-on:click" => "close_collapse(#{index})" )%>
              </template>
              <template v-slot:title>
                <%= "Editar estudio #{procedure_type.procedure_type_name}" %>
              </template>
              <template v-slot:content>
                <div class="flex flex-wrap -mx-3 mb-5">
                  <div class="w-full md:w-1/3 px-3 mb-5 md:mb-0 focus_form">
                    <%= f.label "Nombre del tipo de estudio", class: 'label_input' %>
                    <%= f.text_field :procedure_type_name, value: procedure_type.procedure_type_name, class: 'field_input rounded-t' %>
                  </div>
                  <div class="w-full md:w-1/3 px-3 focus_form ">
                    <%= f.label "Costo por defecto", class: 'label_input' %>
                    <%= f.number_field :cost, value: procedure_type.cost, class: 'field_input rounded-t' %>
                  </div>
                  <div class="w-full md:w-1/3 px-3 focus_form ">
                    <%= f.label "Duracion (En minutos)", class: 'label_input' %>
                    <%= f.number_field :procedure_duration, value: procedure_type.procedure_duration, class: 'field_input rounded-t' %>
                  </div>
                </div>
              </template>
              <template v-slot:footer>
                <div class="flex justify-start w-1/2">
                  <%= link_to procedure_type_path(procedure_type.id), method: 'delete', data: {confirm: 'Esto elimnara el registro, ¿esta seguro?'}, class: "btn btn-red-light mx-1"  do %>
                    <%= icon('fas', 'trash') %>
                  <% end %>
                </div>
                <div class="flex justify-end w-1/2">
                  <button type="button" name="button" class="btn btn-red-light mx-1" @click="btnModal()">Cancelar</button>
                  <%= f.submit "Registrar", class: "btn btn-primary"%>
                </div>     
              </template>
            </modal-vue>
            <% end %>
          </td>
          <td><%= procedure_type.procedure_type_name %></td>
          <td><%= procedure_type.cost %></td>
          <td><%= procedure_type.procedure_duration %></td>
        </tr>
       <% end %>
      </tbody>
    </table>
  </div>
  <% else %>
    <div class="alert alert-info mx-4" role="alert">
      <div class="flex">
        <%= icon('fa', icon_alert['info'], class: 'mr-3 fa-2x') %>
        <div class="text-teal-darkest w-full">
          <p class="font-bold">Atención.</p>
          <p class="text-sm">Aun no se registran tipos de estudio, haga click en el '+' para agreagr una</p>
        </div>
      </div>
    </div>
  <% end %>
<% end %>
