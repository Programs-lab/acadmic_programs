<%= render  'shared/card' do %>

<div id=procedure_types_index>

  <div class="my-8 flex px-4 items-center">
    <div class="flex w-1/2">
      <h4 class="font-semibold text-g-d4 text-lg">
        Tipos de estudio
        <br><span class="font-medium text-sm text-g-d2">Listado de tipos de estudio</span>
      </h4>
    </div>




    <div class="flex w-1/2 justify-end">
      <a id="myBtn" @click="modalId('create')">
        <%= icon('fas','plus', class: 'btn btn-primary cursor-pointer fa-md', "v-ripple" => "'rgba(255, 255, 255, 0.20)'")%>
      </a>
    </div>

      <%= form_with scope: :procedure_type, url: procedure_types_path, method: :post, local: true do |form|%>

        <modal-vue i= "create" style_modal="width: 45%;">
          <template v-slot:title>
            Agrergar Estudio
          </template>
          <template v-slot:content>
            <div class="flex flex-wrap mx-auto" style="width: 86.666%;">
              <div class="w-full mb-6 focus_form">
                <%= form.label "Nombre del tipo de estudio", class: 'label_input' %>
                <%= form.text_field :procedure_type_name, class: 'field_input rounded-t' %>
              </div>
              <div class="w-full mb-6 focus_form">
                <%= form.label "Costo por defecto", class: 'label_input' %>
                <%= form.number_field :cost, class: 'field_input rounded-t' %>
              </div>
              <div class="w-full mb-6 focus_form">
                <%= form.label "Duracion (En minutos)", class: 'label_input' %>
                <%= form.number_field :procedure_duration, class: 'field_input rounded-t' %>
              </div>
              <div class="w-full mb-6 focus_form">
                <%= form.label "Tipo", class: 'label_input' %>
                <%=
                  form.collection_select(
                    :kind,
                    PROCEDURE_KINDS,
                    :first,
                    :last,
                    {include_blank: true},
                    {
                      class: "block appearance-none w-full border-b text-grey-darker py-3 px-4 pr-8 focus:outline-none bg-white focus:border-grey h-8"
                    }
                  )
                %>
              </div>
            </div>
          </template>
          <template v-slot:footer>
            <button type="button" name="button" class="btn btn-red-light mx-1" @click="modalId('create')">Cancelar</button>
            <%= form.submit "Registrar", class: 'btn btn-primary' %>
          </template>
        </modal-vue>

      <% end %>

    </div>


<br><span class="font-medium text-lg px-4 text-g-d2">Consultas</span>
<br>
<br>
<% if @consultations.any? %>
    <div class="px-0 md:px-4 overflow-auto">
      <table>
      <form>
        <input type="text" name="">
      </form>
      </table>
    <!-- table heading -->
    <table class="table">
      <thead>
        <tr>
          <th scope="col" width=13%></th>
          <th scope="col" width=30%>Nombre</th>
          <th scope="col" width=30%>Costo</th>
          <th scope="col" >Duracion</th>
        </tr>
      </thead>
      <tbody class="">
        <% @consultations.each_with_index do |procedure_type, index| %>
        <tr>
          <td>
           <a id="myBtn" @click="modalId('update_c<%= index %>')">
            <%= icon('fas','pencil-alt', class: 'btn btn-secondary cursor-pointer fa-md', "v-ripple" => "'rgba(0, 0, 0, 0.20)'")%>
          </a>
          <%= form_with scope: :procedure_type, url: procedure_type_path(procedure_type.id), method: 'put', class: "", local: true, remote: true do |f| %>
        <modal-vue i="update_c<%= index %>" style_modal="width: 45%;">
          <template v-slot:title>
            <%= "Editar estudio #{procedure_type.procedure_type_name}" %>
          </template>
          <template v-slot:content>
            <div class="flex flex-wrap mx-auto" style="width: 86.666%;">
              <div class="w-full mb-6 focus_form">
                <%= f.label "Nombre del tipo de estudio", class: 'label_input' %>
                <%= f.text_field :procedure_type_name, value: procedure_type.procedure_type_name, class: 'field_input rounded-t' %>
              </div>
              <div class="w-full mb-6 focus_form">
                <%= f.label "Costo por defecto", class: 'label_input' %>
                <%= f.number_field :cost, value: procedure_type.cost, class: 'field_input rounded-t' %>
              </div>
              <div class="w-full mb-6 focus_form">
                <%= f.label "Duracion (En minutos)", class: 'label_input' %>
                <%= f.number_field :procedure_duration, value: procedure_type.procedure_duration, class: 'field_input rounded-t' %>
              </div>
              <div class="w-full mb-6 focus_form">
                <%= f.label "Tipo", class: 'label_input' %>
                <%=
                  f.collection_select(
                    :kind,
                    PROCEDURE_KINDS,
                    :first,
                    :last,
                    {include_blank: true, selected: procedure_type.kind},
                    {
                      class: "block appearance-none w-full border-b text-grey-darker py-3 px-4 pr-8 focus:outline-none bg-white focus:border-grey h-8"
                    }
                  )
                %>
              </div>
            </div>
          </template>
          <template v-slot:footer>
            <div class="flex justify-start w-1/2">
              <a class="btn btn-red-light mx-1" @click="alert = true">
                <i class="fas fa-trash"></i>
              </a>
              <div class="flex w-auto justify-start ml-2 items-center" v-show='alert'>
                <span class="mr-4">¿Esta seguro?</span>                
                <a class="btn btn-secondary" @click="alert = false">
                  <span>No</span>
                </a>
                  <%= link_to  "Sí", procedure_type_path(procedure_type.id), method: 'delete', class: "btn btn-secondary mx-1" %> 
              </div>
            </div>

            <div class="flex justify-end w-1/2">
              <button type="button" name="button" class="btn btn-red-light mx-1" @click="modalId('update_c<%= index %>')">Cancelar</button>
              <%= f.submit "Registrar", class: "btn btn-primary"%>
            </div>
          </template>
        </modal-vue>
      <% end %>
        </td>
          <td><%= procedure_type.procedure_type_name %></td>
          <td><%= procedure_type.cost %></td>
          <td><%= procedure_type.procedure_duration %></td>
        </tr>

      
       <% end %>
      </tbody>
    </table>
  </div>
  <% else %>
    <div class="alert alert-info mx-4" role="alert">
      <div class="flex">
        <%= icon('fa', icon_alert['info'], class: 'mr-3 fa-2x') %>
        <div class="text-teal-darkest w-full">
          <p class="font-bold">Atención.</p>
          <p class="text-sm">Aun no se registran estudios de consulta, haga click en el '+' para agreagr una</p>
        </div>
      </div>
    </div>
  <% end %>
<br><span class="font-medium text-lg px-4 text-g-d2">Procedimientos</span>
<br>
<br>
<% if @procedures.any? %>
    <div class="px-0 md:px-4 overflow-auto">
    <!-- table heading -->
    <table class="table">
      <thead>
        <tr>
          <th scope="col" width=13%></th>
          <th scope="col" width=30%>Nombre</th>
          <th scope="col" width=30%>Costo</th>
          <th scope="col" >Duracion</th>
        </tr>
      </thead>
      <tbody class="">
        <% @procedures.each_with_index do |procedure_type, index| %>
        <tr>
          <td>
           <a id="myBtn" @click="modalId('update_p<%= index %>')">
            <%= icon('fas','pencil-alt', class: 'btn btn-secondary cursor-pointer fa-md', "v-ripple" => "'rgba(0, 0, 0, 0.20)'")%>
          </a>
          <%= form_with scope: :procedure_type, url: procedure_type_path(procedure_type.id), method: 'put', class: "", local: true  do |f| %>
            <modal-vue i="update_p<%= index %>" style_modal="width: 45%;">
              <template v-slot:title>
                <%= "Editar estudio #{procedure_type.procedure_type_name}" %>
              </template>
              <template v-slot:content>
                <div class="flex flex-wrap mx-auto" style="width: 86.666%;">
                  <div class="w-full mb-6 focus_form">
                    <%= f.label "Nombre del tipo de estudio", class: 'label_input' %>
                    <%= f.text_field :procedure_type_name, value: procedure_type.procedure_type_name, class: 'field_input rounded-t' %>
                  </div>
                  <div class="w-full mb-6 focus_form">
                    <%= f.label "Costo por defecto", class: 'label_input' %>
                    <%= f.number_field :cost, value: procedure_type.cost, class: 'field_input rounded-t' %>
                  </div>
                  <div class="w-full mb-6 focus_form">
                    <%= f.label "Duracion (En minutos)", class: 'label_input' %>
                    <%= f.number_field :procedure_duration, value: procedure_type.procedure_duration, class: 'field_input rounded-t' %>
                  </div>
                  <div class="w-full mb-6 focus_form">
                    <%= f.label "Tipo", class: 'label_input' %>
                    <%=
                      f.collection_select(
                        :kind,
                        PROCEDURE_KINDS,
                        :first,
                        :last,
                        {include_blank: true, selected: procedure_type.kind},
                        {
                          class: "block appearance-none w-full border-b text-grey-darker py-3 px-4 pr-8 focus:outline-none bg-white focus:border-grey h-8"
                        }
                      )
                    %>
                  </div>
                </div>
              </template>
              <template v-slot:footer>
                <div class="flex justify-start w-1/2">
                  <%= link_to procedure_type_path(procedure_type.id), method: 'delete', data: {confirm: 'Esto elimnara el registro, ¿esta seguro?'}, class: "btn btn-red-light mx-1"  do %>
                    <%= icon('fas', 'trash') %>
                  <% end %>
                </div>
                <div class="flex justify-end w-1/2">
                  <button type="button" name="button" class="btn btn-red-light mx-1" @click="modalId('update_p<%= index %>')">Cancelar</button>
                  <%= f.submit "Registrar", class: "btn btn-primary"%>
                </div>
              </template>
            </modal-vue>
          <% end %>
          </td>
          <td><%= procedure_type.procedure_type_name %></td>
          <td><%= procedure_type.cost %></td>
          <td><%= procedure_type.procedure_duration %></td>
        </tr>


       <% end %>
      </tbody>
    </table>
  </div>
  <% else %>
    <div class="alert alert-info mx-4" role="alert">
      <div class="flex">
        <%= icon('fa', icon_alert['info'], class: 'mr-3 fa-2x') %>
        <div class="text-teal-darkest w-full">
          <p class="font-bold">Atención.</p>
          <p class="text-sm">Aun no se registran estudios de consulta, haga click en el '+' para agreagr una</p>
        </div>
      </div>
    </div>
  <% end %>



<% end %>
